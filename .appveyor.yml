image: Visual Studio 2017
platform:
- x64

clone_folder: c:\gopath\src\github.com\skycoin\cx

environment:
  GOPATH: c:\gopath

stack: go 1.11

# Install dev dependencies
install:
  - set PATH=c:\mingw-w64\bin;%GOPATH%\bin;c:\go\bin;%PATH%
  - dir c:\mingw-w64\bin
  - c:\mingw-w64\bin\mingw-get install gcc g++ mingw32-make
  - go version
  - go get github.com/skycoin/skycoin/...
  - go get github.com/go-gl/gl/v2.1/gl
  - go get github.com/go-gl/glfw/v3.2/glfw
  - go get github.com/go-gl/gltext
  - go get github.com/blynn/nex
  - go get github.com/cznic/goyacc
  - go get github.com/skycoin/cx/...

before_build:
  - nex -e %GOPATH%\src\github.com\skycoin\cx\cxgo\cxgo0\cxgo0.nex
  - goyacc -o %GOPATH%\src\github.com\skycoin\cx\cxgo\cxgo0\cxgo0.go %GOPATH%\src\github.com\skycoin\cx\cxgo\cxgo0\cxgo0.y
  - nex -e %GOPATH%\src\github.com\skycoin\cx\cxgo\cxgo.nex
  - goyacc -o %GOPATH%\src\github.com\skycoin\cx\cxgo\cxgo.go %GOPATH%\src\github.com\skycoin\cx\cxgo\cxgo.y

build_script:
  - go build -race -tags full -i -o %GOPATH%\bin\cx github.com\skycoin\cx\cxgo\

test_script:
  - go test -race -tags full -i -o %GOPATH%\bin\cx github.com\skycoin\cx\cxgo\
